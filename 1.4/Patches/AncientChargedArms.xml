<?xml version="1.0" encoding="utf-8"?>
<!--
    ===== Ancient Charged Arms =====
-->
<Patch>
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Ancient Charged Arms</li>
        </mods>

        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationAdd">
                    <xpath>Defs</xpath>
                    <value>
                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="AW_ChargeSMG_Bond" Abstract="True">
                            <label>persona Ancient Charged PDW</label>
                            <description>An Ancient PDW, it was commonly carried by mech commanders and infiltration units. [SYSTEM LOG 7039]
  [ID: 3837921D]
  
  [LAST ENTRY 2-3-4063]
  I must admit I enjoy having the machines around, but where does this end? It seems like there's no people at all anymore. While we're all stuck inside our homes the droids perform every task in the city. Sometimes I wonder how long this can last. What if something... what if something in the nexus goes wrong? What should we do, what can we do?\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Charged/AW_Charged_SMG</texPath>
                                <drawSize>0.75</drawSize>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>4</Mass>
                                <AccuracyTouch>0.825</AccuracyTouch>
                                <AccuracyShort>0.715</AccuracyShort>
                                <AccuracyMedium>0.33</AccuracyMedium>
                                <AccuracyLong>0.22</AccuracyLong>
                                <RangedWeapon_Cooldown>1.19</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedLight</li>
                                <li>Ultratech</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_AW_ChargeSMG_Bond</defaultProjectile>
                                    <warmupTime>0.85</warmupTime>
                                    <range>25.9</range>
                                    <ticksBetweenBurstShots>6</ticksBetweenBurstShots>
                                    <burstShotCount>6</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                            <modExtensions>
                                <li Class="MuzzleFlash.MuzzleFlashProps" MayRequire="issaczhuang.muzzleflash">
                                    <def>MF_ChargedMuzzleFalsh</def>
                                    <drawSize>(1,1)</drawSize>
                                    <offsets>
                                        <li>(0.4,0)</li>
                                    </offsets>
                                </li>
                            </modExtensions>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_Bullet" Name="Bullet_AW_ChargeSMG_Bond" Abstract="True">
                            <label>charge shot</label>
                            <graphicData>
                                <texPath>Things/Projectile/Charge_Small</texPath>
                            </graphicData>
                            <projectile>
                                <damageAmountBase>13</damageAmountBase>
                                <armorPenetrationBase>0.45</armorPenetrationBase>
                                <speed>70</speed>
                            </projectile>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="AW_ChargeBR_Bond" Abstract="True">
                            <label>persona Ancient Charged BR</label>
                            <description>An Ancient BR, it was commonly issued to mech assisted infantry. [SYSTEM LOG: 5289]
  [ID: 4041323G]
  
  [LAST ENTRY 4-12-4062]
  I love these things! Every update these little droids get better, keeps making my job easier. I can't even imagine living without them anymore. I will never understand why those Southern fools continue to fight nexus's gift. How can they still deny the Empire's glory even after all this time? Damn fools, maybe the commander will send the machines again. Should teach them to look a gift droid in the mouth. Ha! That's a good one! I've got to remember that.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Charged/AW_Charged_BR</texPath>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>6.3</Mass>
                                <AccuracyTouch>0.66</AccuracyTouch>
                                <AccuracyShort>0.704</AccuracyShort>
                                <AccuracyMedium>0.715</AccuracyMedium>
                                <AccuracyLong>0.495</AccuracyLong>
                                <RangedWeapon_Cooldown>1.87</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedLight</li>
                                <li>Ultratech</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_AW_ChargeBR_Bond</defaultProjectile>
                                    <warmupTime>0.85</warmupTime>
                                    <range>36.9</range>
                                    <ticksBetweenBurstShots>15</ticksBetweenBurstShots>
                                    <burstShotCount>5</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                            <modExtensions>
                                <li Class="MuzzleFlash.MuzzleFlashProps" MayRequire="issaczhuang.muzzleflash">
                                    <def>MF_ChargedMuzzleFalsh</def>
                                    <drawSize>(1,1)</drawSize>
                                    <offsets>
                                        <li>(0.5,0)</li>
                                    </offsets>
                                </li>
                            </modExtensions>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_Bullet" Name="Bullet_AW_ChargeBR_Bond" Abstract="True">
                            <label>charge shot</label>
                            <graphicData>
                                <texPath>Things/Projectile/Charge_Small</texPath>
                            </graphicData>
                            <projectile>
                                <damageAmountBase>24</damageAmountBase>
                                <armorPenetrationBase>0.45</armorPenetrationBase>
                                <speed>70</speed>
                            </projectile>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="AW_ChargeLMG_Bond" Abstract="True">
                            <label>persona Ancient Charged HMG</label>
                            <description>An Ancient HMG, it was commonly issued to mech assisted infantry squads. [SYSTEM LOG: 1703]
  [ID: 2029321C]
  
  [LAST ENTRY 3-14-4059]
  The new war protocol for the nexus is performing better than we anticipated. With the tribes fleeing our droids East of Planetary landing point we'll be able to spare more fighters for the Southern assault. I had my doubts of her... sorry the protocol's effectiveness, but even I can not deny the results. Our enemies will be routed before the sun is up. Soon this war will be over and we can all go home.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Charged/AW_Charged_HMG</texPath>
                                <drawSize>1.5</drawSize>
                            </graphicData>
                            <equippedAngleOffset>45</equippedAngleOffset>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>22.6</Mass>
                                <AccuracyTouch>0.66</AccuracyTouch>
                                <AccuracyShort>0.704</AccuracyShort>
                                <AccuracyMedium>0.715</AccuracyMedium>
                                <AccuracyLong>0.605</AccuracyLong>
                                <RangedWeapon_Cooldown>1.955</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <equippedStatOffsets>
                                <MoveSpeed>-0.15</MoveSpeed>
                            </equippedStatOffsets>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedHeavy</li>
                                <li>Ultratech</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_AW_ChargeBR_Bond</defaultProjectile>
                                    <warmupTime>0.85</warmupTime>
                                    <range>29.9</range>
                                    <ticksBetweenBurstShots>15</ticksBetweenBurstShots>
                                    <burstShotCount>9</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                            <modExtensions>
                                <li Class="MuzzleFlash.MuzzleFlashProps" MayRequire="issaczhuang.muzzleflash">
                                    <def>MF_ChargedMuzzleFalsh</def>
                                    <drawSize>(2,1)</drawSize>
                                    <offsets>
                                        <li>(0.8,0)</li>
                                    </offsets>
                                </li>
                            </modExtensions>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="AW_ChargeSR_Bond" Abstract="True">
                            <label>persona Ancient Charged AMR</label>
                            <description>An Ancient AMR, it was commonly issued to mech assisted sharpshooters and infiltration units. [SYSTEM LOG: 11329]
  [ID: 2098732L]
  
  [LAST ENTRY 1-15-4064]
  Something in the nexus has gone horribly wrong! We've lost all contact with the forward station and the droids are not responding to commands! There's gunfire on the front. I think the Southies are making a push for the city! Send help!\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Charged/AW_Charged_AMR</texPath>
                                <drawSize>1.25</drawSize>
                            </graphicData>
                            <equippedAngleOffset>45</equippedAngleOffset>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>6.3</Mass>
                                <AccuracyTouch>0.33</AccuracyTouch>
                                <AccuracyShort>0.374</AccuracyShort>
                                <AccuracyMedium>0.935</AccuracyMedium>
                                <AccuracyLong>1.045</AccuracyLong>
                                <RangedWeapon_Cooldown>1.87</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <equippedStatOffsets>
                                <MoveSpeed>-0.30</MoveSpeed>
                            </equippedStatOffsets>
                            <weaponClasses>
                                <li>RangedHeavy</li>
                                <li>Ultratech</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_AW_ChargeSR_Bond</defaultProjectile>
                                    <warmupTime>0.85</warmupTime>
                                    <range>39.9</range>
                                    <ticksBetweenBurstShots>15</ticksBetweenBurstShots>
                                    <burstShotCount>3</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                            <modExtensions>
                                <li Class="MuzzleFlash.MuzzleFlashProps" MayRequire="issaczhuang.muzzleflash">
                                    <def>MF_ChargedMuzzleFalsh</def>
                                    <drawSize>(3,1)</drawSize>
                                    <offsets>
                                        <li>(0.7,0)</li>
                                    </offsets>
                                </li>
                            </modExtensions>
                        </ThingDef>

                        <ThingDef ParentName="MPBFPM_Bullet" Name="Bullet_AW_ChargeSR_Bond" Abstract="True">
                            <label>charge shot</label>
                            <graphicData>
                                <texPath>Things/Projectile/Charge_Small</texPath>
                            </graphicData>
                            <projectile>
                                <damageAmountBase>35</damageAmountBase>
                                <armorPenetrationBase>1.05</armorPenetrationBase>
                                <stoppingPower>1.5</stoppingPower>
                                <speed>140</speed>
                            </projectile>
                        </ThingDef>
                    </value>
                </li>

                <li Class="PatchOperationFindMod">
                    <mods>
                        <li>XML Extensions</li>
                    </mods>

                    <nomatch Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <!-- AW_ChargeSMG_Bond -->
                            <ThingDef ParentName="AW_ChargeSMG_Bond">
                                <defName>AW_ChargeSMG_Bond</defName>
                            </ThingDef>

                            <!-- Bullet_AW_ChargeSMG_Bond -->
                            <ThingDef ParentName="Bullet_AW_ChargeSMG_Bond">
                                <defName>Bullet_AW_ChargeSMG_Bond</defName>
                            </ThingDef>

                            <!-- AW_ChargeBR_Bond -->
                            <ThingDef ParentName="AW_ChargeBR_Bond">
                                <defName>AW_ChargeBR_Bond</defName>
                            </ThingDef>

                            <!-- Bullet_AW_ChargeBR_Bond -->
                            <ThingDef ParentName="Bullet_AW_ChargeBR_Bond">
                                <defName>Bullet_AW_ChargeBR_Bond</defName>
                            </ThingDef>

                            <!-- AW_ChargeLMG_Bond -->
                            <ThingDef ParentName="AW_ChargeLMG_Bond">
                                <defName>AW_ChargeLMG_Bond</defName>
                            </ThingDef>

                            <!-- AW_ChargeSR_Bond -->
                            <ThingDef ParentName="AW_ChargeSR_Bond">
                                <defName>AW_ChargeSR_Bond</defName>
                            </ThingDef>

                            <!-- Bullet_AW_ChargeSR_Bond -->
                            <ThingDef ParentName="Bullet_AW_ChargeSR_Bond">
                                <defName>Bullet_AW_ChargeSR_Bond</defName>
                            </ThingDef>
                        </value>
                    </nomatch>

                    <match Class="PatchOperationSequence">
                        <operations>
                            <li Class="XmlExtensions.OptionalPatch" MayRequire="imranfish.xmlextensions">
                                <modId>Daria40K.MightyPersonaBondForgePatch</modId>
                                <key>Daria40K_MightyPersonaBondForgePatch_AncientChargedArms</key>
                                <defaultValue>true</defaultValue>

                                <caseTrue>
                                    <Operation Class="XmlExtensions.PatchOperationAdd">
                                        <xpath>Defs</xpath>
                                        <value>
                                            <!-- AW_ChargeSMG_Bond -->
                                            <ThingDef ParentName="AW_ChargeSMG_Bond">
                                                <defName>AW_ChargeSMG_Bond</defName>
                                            </ThingDef>

                                            <!-- Bullet_AW_ChargeSMG_Bond -->
                                            <ThingDef ParentName="Bullet_AW_ChargeSMG_Bond">
                                                <defName>Bullet_AW_ChargeSMG_Bond</defName>
                                            </ThingDef>

                                            <!-- AW_ChargeBR_Bond -->
                                            <ThingDef ParentName="AW_ChargeBR_Bond">
                                                <defName>AW_ChargeBR_Bond</defName>
                                            </ThingDef>

                                            <!-- Bullet_AW_ChargeBR_Bond -->
                                            <ThingDef ParentName="Bullet_AW_ChargeBR_Bond">
                                                <defName>Bullet_AW_ChargeBR_Bond</defName>
                                            </ThingDef>

                                            <!-- AW_ChargeLMG_Bond -->
                                            <ThingDef ParentName="AW_ChargeLMG_Bond">
                                                <defName>AW_ChargeLMG_Bond</defName>
                                            </ThingDef>

                                            <!-- AW_ChargeSR_Bond -->
                                            <ThingDef ParentName="AW_ChargeSR_Bond">
                                                <defName>AW_ChargeSR_Bond</defName>
                                            </ThingDef>

                                            <!-- Bullet_AW_ChargeSR_Bond -->
                                            <ThingDef ParentName="Bullet_AW_ChargeSR_Bond">
                                                <defName>Bullet_AW_ChargeSR_Bond</defName>
                                            </ThingDef>
                                        </value>
                                    </Operation>
                                </caseTrue>
                            </li>
                        </operations>
                    </match>
                </li>
            </operations>
        </match>
    </Operation>
</Patch>
