<!--
    ===== Imperial arsenal =====
-->
<Patch>
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Imperial arsenal</li>
        </mods>

        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationAdd">
                    <xpath>Defs</xpath>
                    <value>
                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="Gun_ICW_ChargeLMG_Bond" Abstract="True">
                            <label>persona imperial plasma machinegun</label>
                            <description>Based on the charge machinegun,the empire designed this weapon. It not only deals extraordinary damage,but also has gorgeous fire rate. The special components make it too cumbersome,so it will greatly reduce the move speed of the wielder.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Item/Equipment/WeaponRanged/ICW_ChargeLMG</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>12.5</Mass>
                                <AccuracyTouch>0.303</AccuracyTouch>
                                <AccuracyShort>0.448</AccuracyShort>
                                <AccuracyMedium>0.52</AccuracyMedium>
                                <AccuracyLong>0.242</AccuracyLong>
                                <RangedWeapon_Cooldown>1.011</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedHeavy</li>
                            </weaponClasses>
                            <equippedStatOffsets>
                                <MoveSpeed>-0.25</MoveSpeed>
                            </equippedStatOffsets>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_ICW_ChargeLMG_Bond</defaultProjectile>
                                    <warmupTime>4.2</warmupTime>
                                    <range>32.9</range>
                                    <ticksBetweenBurstShots>3</ticksBetweenBurstShots>
                                    <burstShotCount>23</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="Gun_ICW_AdvChargeRifle_Bond" Abstract="True">
                            <label>persona imperial plasma rifle</label>
                            <description>Improving on the common charge rifle which has short range and poor damage.The imperial plasma rifle is completely different, with long range and high damage, makes it an all-round weapon.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Item/Equipment/WeaponRanged/ICW_AdvChargeRF</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>3.6</Mass>
                                <AccuracyTouch>0.786</AccuracyTouch>
                                <AccuracyShort>0.907</AccuracyShort>
                                <AccuracyMedium>0.907</AccuracyMedium>
                                <AccuracyLong>0.665</AccuracyLong>
                                <RangedWeapon_Cooldown>0.578</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedLight</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_ChargeRifle_Bond</defaultProjectile>
                                    <warmupTime>2.0</warmupTime>
                                    <range>36.9</range>
                                    <ticksBetweenBurstShots>7</ticksBetweenBurstShots>
                                    <burstShotCount>3</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="Gun_ICW_ChargeSG_Bond" Abstract="True">
                            <label>persona imperial plasma shotgun</label>
                            <description>A enhanced shotgun that makes short work of both enemy and structure. Some imperial nobels consider weapon of this kind cruel, but the others think it is just a good punishment for those who dare to challenge the empire.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Item/Equipment/WeaponRanged/ICW_ChargeSG</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>4.5</Mass>
                                <AccuracyTouch>0.907</AccuracyTouch>
                                <AccuracyShort>0.786</AccuracyShort>
                                <AccuracyMedium>0.762</AccuracyMedium>
                                <AccuracyLong>0.69</AccuracyLong>
                                <RangedWeapon_Cooldown>0.289</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedHeavy</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_ICW_ChargeSG_Bond</defaultProjectile>
                                    <warmupTime>2.0</warmupTime>
                                    <range>17.9</range>
                                    <ticksBetweenBurstShots>15</ticksBetweenBurstShots>
                                    <burstShotCount>2</burstShotCount>
                                    <soundCast>Shot_ChargeRifle</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="Gun_ICW_ChargeSR_Bond" Abstract="True">
                            <label>persona imperial plasma lance</label>
                            <description>A specialist weapon designed for long-range battles. Only the best snipers of the empire are assigned to it.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                            <techLevel>Spacer</techLevel>
                            <graphicData>
                                <texPath>Things/Item/Equipment/WeaponRanged/ICW_ChargeSR</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                                <drawSize>1.2</drawSize>
                            </graphicData>
                            <soundInteract>Interact_ChargeRifle</soundInteract>
                            <statBases>
                                <Mass>4.5</Mass>
                                <AccuracyTouch>0.484</AccuracyTouch>
                                <AccuracyShort>0.786</AccuracyShort>
                                <AccuracyMedium>1.028</AccuracyMedium>
                                <AccuracyLong>1.089</AccuracyLong>
                                <RangedWeapon_Cooldown>0.722</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>SpacerGun</li>
                            </weaponTags>
                            <tradeTags>
                                <li>WeaponRanged</li>
                            </tradeTags>
                            <weaponClasses>
                                <li>RangedHeavy</li>
                            </weaponClasses>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>Bullet_ICW_ChargeSR_Bond</defaultProjectile>
                                    <warmupTime>4.8</warmupTime>
                                    <range>44.9</range>
                                    <soundCast>ChargeLance_Fire</soundCast>
                                    <soundCastTail>GunTail_Heavy</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>9.75</power>
                                    <cooldownTime>1.7</cooldownTime>
                                </li>
                            </tools>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseBullet" Name="Bullet_ICW_ChargeLMG_Bond" Abstract="True">
                            <label>charge shot</label>
                            <graphicData>
                                <texPath>Things/Projectile/Charge_Small</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                            </graphicData>
                            <projectile>
                                <damageDef>Bullet</damageDef>
                                <damageAmountBase>15</damageAmountBase>
                                <armorPenetrationBase>0.35</armorPenetrationBase>
                                <speed>70</speed>
                            </projectile>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseBullet" Name="Bullet_ICW_ChargeSG_Bond" Abstract="True">
                            <label>charge blast</label>
                            <graphicData>
                                <texPath>Things/Projectile/Bullet_Shotgun</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                                <color>(159,248,255)</color>
                            </graphicData>
                            <projectile>
                                <damageDef>Bullet</damageDef>
                                <damageAmountBase>24</damageAmountBase>
                                <armorPenetrationBase>0.45</armorPenetrationBase>
                                <stoppingPower>1.5</stoppingPower>
                                <extraDamages>
                                    <li>
                                        <def>Thump</def>
                                        <amount>0.3</amount>
                                    </li>
                                </extraDamages>
                                <speed>70</speed>
                            </projectile>
                        </ThingDef>
                        <ThingDef ParentName="MPBFPM_BaseBullet" Name="Bullet_ICW_ChargeSR_Bond" Abstract="True">
                            <label>charge lance shot</label>
                            <graphicData>
                                <texPath>Things/Projectile/ChargeLanceShot</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                                <shaderType>TransparentPostLight</shaderType>
                                <drawSize>1.5</drawSize>
                            </graphicData>
                            <projectile>
                                <damageDef>Bullet</damageDef>
                                <damageAmountBase>41</damageAmountBase>
                                <armorPenetrationBase>0.65</armorPenetrationBase>
                                <stoppingPower>1.5</stoppingPower>
                                <speed>120</speed>
                            </projectile>
                        </ThingDef>
                    </value>
                </li>
                <li Class="PatchOperationFindMod">
                    <mods>
                        <li>XML Extensions</li>
                    </mods>

                    <nomatch Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <ThingDef ParentName="Gun_ICW_ChargeLMG_Bond">
                                <defName>Gun_ICW_ChargeLMG_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Gun_ICW_AdvChargeRifle_Bond">
                                <defName>Gun_ICW_AdvChargeRifle_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Gun_ICW_ChargeSG_Bond">
                                <defName>Gun_ICW_ChargeSG_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Gun_ICW_ChargeSR_Bond">
                                <defName>Gun_ICW_ChargeSR_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Bullet_ICW_ChargeLMG_Bond">
                                <defName>Bullet_ICW_ChargeLMG_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Bullet_ICW_ChargeSG_Bond">
                                <defName>Bullet_ICW_ChargeSG_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="Bullet_ICW_ChargeSR_Bond">
                                <defName>Bullet_ICW_ChargeSR_Bond</defName>
                            </ThingDef>
                        </value>
                    </nomatch>

                    <match Class="PatchOperationSequence">
                        <operations>
                            <li Class="XmlExtensions.OptionalPatch" MayRequire="imranfish.xmlextensions">
                                <modId>Daria40K.MightyPersonaBondForgePatch</modId>
                                <key>Daria40K_MightyPersonaBondForgePatch_Imperialarsenal</key>
                                <defaultValue>true</defaultValue>

                                <caseTrue>
                                    <Operation Class="XmlExtensions.PatchOperationAdd">
                                        <xpath>Defs</xpath>
                                        <value>
                                            <ThingDef ParentName="Gun_ICW_ChargeLMG_Bond">
                                                <defName>Gun_ICW_ChargeLMG_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Gun_ICW_AdvChargeRifle_Bond">
                                                <defName>Gun_ICW_AdvChargeRifle_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Gun_ICW_ChargeSG_Bond">
                                                <defName>Gun_ICW_ChargeSG_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Gun_ICW_ChargeSR_Bond">
                                                <defName>Gun_ICW_ChargeSR_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Bullet_ICW_ChargeLMG_Bond">
                                                <defName>Bullet_ICW_ChargeLMG_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Bullet_ICW_ChargeSG_Bond">
                                                <defName>Bullet_ICW_ChargeSG_Bond</defName>
                                            </ThingDef>
                                            <ThingDef ParentName="Bullet_ICW_ChargeSR_Bond">
                                                <defName>Bullet_ICW_ChargeSR_Bond</defName>
                                            </ThingDef>
                                        </value>
                                    </Operation>
                                </caseTrue>
                            </li>
                        </operations>
                    </match>
                </li>
            </operations>
        </match>
    </Operation>
</Patch>