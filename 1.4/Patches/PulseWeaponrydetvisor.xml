<!--
    ===== Pulse Weaponry detvisor =====
-->
<Patch>
    <Operation Class="XmlExtensions.FindMod">
        <mods>
            <li>detvisor.pulseweaponry</li>
        </mods>
        <packageId>True</packageId>

        <caseTrue>
            <Operation Class="PatchOperationAdd">
                <xpath>Defs</xpath>
                <value>
                    <ThingDef ParentName="MPBFPM_BaseMeleeWeapon_Blunt" Name="DV_MeleeWeapon_Stunstick_Bond" Abstract="True">
                        <label>persona stunstick</label>
                        <description>A battery powered melee stun device. On hit, it releases surges of high voltage, which spread across the target's body and disrupt voluntary control of muscles.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                        <graphicData>
                            <texPath>Things/WeaponMelee/Stunstick</texPath>
                            <drawSize>1.1</drawSize>
                            <graphicClass>Graphic_Single</graphicClass>
                        </graphicData>
                        <meleeHitSound>MeleeHit_Stunstick</meleeHitSound>
                        <researchPrerequisites>
                            <li>DV_PulseEnergyWeapons</li>
                        </researchPrerequisites>
                        <uiIconScale>1.1</uiIconScale>
                        <techLevel>Spacer</techLevel>
                        <weaponClasses>
                            <li>Melee</li>
                            <li>MeleeBlunt</li>
                        </weaponClasses>
                        <statBases>
                            <Mass>2</Mass>
                        </statBases>
                        <equippedAngleOffset>-65</equippedAngleOffset>
                        <tools>
                            <li>
                                <label>handle</label>
                                <capacities>
                                    <li>Poke</li>
                                </capacities>
                                <power>10.828</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                            <li>
                                <label>head</label>
                                <labelUsedInLogging>false</labelUsedInLogging>
                                <capacities>
                                    <li>Blunt</li>
                                </capacities>
                                <power>12.0</power>
                                <cooldownTime>1.785</cooldownTime>
                                <extraMeleeDamages>
                                    <li>
                                        <def>Stun</def>
                                        <amount>7</amount>
                                        <chance>1</chance>
                                    </li>
                                </extraMeleeDamages>
                            </li>
                        </tools>
                    </ThingDef>
                    <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="DV_PulseSMG_Bond" Abstract="True">
                        <techLevel>Spacer</techLevel>
                        <label>persona pulse SMG</label>
                        <description>A portable pulse-energy submachine gun. It fires bursts of pulse plugs with high accuracy which disintegrate upon impact, releasing all of their kinetic energy against the target and stopping them in their tracks. \n\nThese deadly weapons are often by urbworld peacekeepers and private military companies alike.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                        <graphicData>
                            <texPath>Things/WeaponRanged/PulseSMG</texPath>
                            <drawSize>1.05</drawSize>
                            <graphicClass>Graphic_Single</graphicClass>
                            <onGroundRandomRotateAngle>35</onGroundRandomRotateAngle>
                        </graphicData>
                        <researchPrerequisites>
                            <li>DV_PulseEnergyWeapons</li>
                        </researchPrerequisites>
                        <soundInteract>Interact_Rifle</soundInteract>
                        <generateCommonality>1.2</generateCommonality>
                        <statBases>
                            <Mass>5.2</Mass>
                            <AccuracyTouch>0.859</AccuracyTouch>
                            <AccuracyShort>0.992</AccuracyShort>
                            <AccuracyMedium>0.944</AccuracyMedium>
                            <AccuracyLong>0.786</AccuracyLong>
                            <RangedWeapon_Cooldown>0.867</RangedWeapon_Cooldown>
                        </statBases>
                        <weaponTags>
                            <li>SpacerGun</li>
                        </weaponTags>
                        <equippedStatOffsets>
                            <MoveSpeed>0.15</MoveSpeed>
                        </equippedStatOffsets>
                        <tradeTags>
                            <li>WeaponRanged</li>
                        </tradeTags>
                        <weaponClasses>
                            <li>RangedLight</li>
                        </weaponClasses>
                        <verbs>
                            <li>
                                <verbClass>Verb_Shoot</verbClass>
                                <label>burst</label>
                                <hasStandardCommand>true</hasStandardCommand>
                                <defaultProjectile>PulseBullet_Bond</defaultProjectile>
                                <warmupTime>1.15</warmupTime>
                                <range>24.5</range>
                                <burstShotCount>3</burstShotCount>
                                <ticksBetweenBurstShots>6</ticksBetweenBurstShots>
                                <soundCast>Shot_PulseLight</soundCast>
                                <soundCastTail>GunTail_Medium</soundCastTail>
                                <muzzleFlashScale>9</muzzleFlashScale>
                            </li>
                        </verbs>
                        <tools>
                            <li>
                                <label>handle</label>
                                <capacities>
                                    <li>Blunt</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                            <li>
                                <label>barrel</label>
                                <capacities>
                                    <li>Blunt</li>
                                    <li>Poke</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                        </tools>
                    </ThingDef>
                    <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="DV_PulseRifle_Bond" Abstract="True">
                        <techLevel>Spacer</techLevel>
                        <label>persona pulse rifle</label>
                        <description>A complex and deadly pulse-energy assault rifle. It fires powerful pulse plugs with high accuracy which disintegrate upon impact, releasing all of their kinetic energy against the target and stopping them in their tracks. Additionally, the pulse rifle is capable of releasing a sphere of volatile electro-pulse energy which can stun and damage electronics. \n\nWeapons like these are utilized by mega-corp militias to silence protests and rebellions, or to conquer planets for their own gains.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                        <graphicData>
                            <texPath>Things/WeaponRanged/PulseRifle</texPath>
                            <drawSize>1.05</drawSize>
                            <graphicClass>Graphic_Single</graphicClass>
                            <onGroundRandomRotateAngle>35</onGroundRandomRotateAngle>
                        </graphicData>
                        <researchPrerequisites>
                            <li>DV_PulseEnergyWeapons</li>
                        </researchPrerequisites>
                        <soundInteract>Interact_Rifle</soundInteract>
                        <generateCommonality>1.05</generateCommonality>
                        <statBases>
                            <Mass>5.2</Mass>
                            <AccuracyTouch>0.835</AccuracyTouch>
                            <AccuracyShort>0.932</AccuracyShort>
                            <AccuracyMedium>1.028</AccuracyMedium>
                            <AccuracyLong>0.871</AccuracyLong>
                            <RangedWeapon_Cooldown>0.722</RangedWeapon_Cooldown>
                        </statBases>
                        <weaponTags>
                            <li>SpacerGun</li>
                        </weaponTags>
                        <tradeTags>
                            <li>WeaponRanged</li>
                        </tradeTags>
                        <weaponClasses>
                            <li>RangedLight</li>
                        </weaponClasses>
                        <verbs>
                            <li>
                                <verbClass>Verb_Shoot</verbClass>
                                <hasStandardCommand>true</hasStandardCommand>
                                <defaultProjectile>PulseBullet_Bond</defaultProjectile>
                                <warmupTime>1.2</warmupTime>
                                <range>29.5</range>
                                <burstShotCount>7</burstShotCount>
                                <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
                                <soundCast>Shot_PulseMedium</soundCast>
                                <soundCastTail>GunTail_Medium</soundCastTail>
                                <muzzleFlashScale>9</muzzleFlashScale>
                            </li>
                        </verbs>
                        <tools>
                            <li>
                                <label>stock</label>
                                <capacities>
                                    <li>Blunt</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                            <li>
                                <label>barrel</label>
                                <capacities>
                                    <li>Blunt</li>
                                    <li>Poke</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                        </tools>
                        <comps>
                            <li Class="AthenaFramework.CompProperties_EquippableAbility">
                                <ability>PulseCharge_Overload</ability>
                            </li>
                        </comps>
                    </ThingDef>
                    <ThingDef ParentName="MPBFPM_BaseHumanMakeableGun" Name="DV_PulseSuppressor_Bond" Abstract="True">
                        <techLevel>Spacer</techLevel>
                        <label>persona pulse suppressor</label>
                        <description>A bulky and menacing pulse-energy powered minigun. Capable of firing large bursts of highly-accurate pulse plugs, which disintegrate upon impact releasing all of their kinetic energy against the target and stopping them in their tracks. \n\nThis intimidating firearm is banned on many glitterworlds due to it's sheer destructive capabilities, yet it is still secretly used by various malicious organizations across the galaxy.\n\nThis weapon has an onboard persona that can bond to only a single person. The wielder and intelligent weapon can synchronize their reflexes and attack with frightening speed, accuracy, and creativity. Once bonded to a wielder, the weapon's persona will refuse to be wielded by anyone else.</description>
                        <equippedAngleOffset>45</equippedAngleOffset>
                        <graphicData>
                            <texPath>Things/WeaponRanged/PulseSuppressor</texPath>
                            <drawSize>1.1</drawSize>
                            <graphicClass>Graphic_Single</graphicClass>
                            <onGroundRandomRotateAngle>35</onGroundRandomRotateAngle>
                        </graphicData>
                        <researchPrerequisites>
                            <li>DV_PulseEnergyWeapons</li>
                        </researchPrerequisites>
                        <soundInteract>Interact_Rifle</soundInteract>
                        <generateCommonality>0.7</generateCommonality>
                        <statBases>
                            <Mass>5.2</Mass>
                            <AccuracyTouch>0.75</AccuracyTouch>
                            <AccuracyShort>0.932</AccuracyShort>
                            <AccuracyMedium>0.92</AccuracyMedium>
                            <AccuracyLong>0.75</AccuracyLong>
                            <RangedWeapon_Cooldown>1.084</RangedWeapon_Cooldown>
                        </statBases>
                        <weaponTags>
                            <li>SpacerGun</li>
                        </weaponTags>
                        <equippedStatOffsets>
                            <MoveSpeed>-0.30</MoveSpeed>
                        </equippedStatOffsets>
                        <tradeTags>
                            <li>WeaponRanged</li>
                        </tradeTags>
                        <weaponClasses>
                            <li>RangedLight</li>
                        </weaponClasses>
                        <verbs>
                            <li>
                                <verbClass>Verb_Shoot</verbClass>
                                <hasStandardCommand>true</hasStandardCommand>
                                <defaultProjectile>PulseBullet_Bond</defaultProjectile>
                                <warmupTime>1.5</warmupTime>
                                <range>24.5</range>
                                <burstShotCount>14</burstShotCount>
                                <ticksBetweenBurstShots>10</ticksBetweenBurstShots>
                                <soundCast>Shot_PulseMedium</soundCast>
                                <soundCastTail>GunTail_Medium</soundCastTail>
                                <muzzleFlashScale>9</muzzleFlashScale>
                            </li>
                        </verbs>
                        <tools>
                            <li>
                                <label>stock</label>
                                <capacities>
                                    <li>Blunt</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                            <li>
                                <label>barrel</label>
                                <capacities>
                                    <li>Blunt</li>
                                    <li>Poke</li>
                                </capacities>
                                <power>9.75</power>
                                <cooldownTime>1.7</cooldownTime>
                            </li>
                        </tools>
                    </ThingDef>
                    <ThingDef ParentName="MPBFPM_BaseBullet" Name="PulseBullet_Bond" Abstract="True">
                        <label>Pulse projectile</label>
                        <graphicData>
                            <texPath>Things/PulseBullet</texPath>
                            <shaderType>TransparentPostLight</shaderType>
                            <graphicClass>Graphic_Single</graphicClass>
                        </graphicData>
                        <projectile>
                            <damageDef>Bullet</damageDef>
                            <damageAmountBase>22</damageAmountBase>
                            <armorPenetrationBase>0.1</armorPenetrationBase>
                            <stoppingPower>4.2</stoppingPower>
                            <speed>85</speed>
                        </projectile>
                        <comps>
                            <li Class="AthenaFramework.CompProperties_ProjectileImpactEffect">
                                <mote>PulseBulletImpact</mote>
                            </li>
                        </comps>
                    </ThingDef>
                </value>
            </Operation>

            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>Daria40K.MightyPersonaBondForgePatch</modId>
                <key>Daria40K_MightyPersonaBondForgePatch_PulseWeaponrydetvisor</key>
                <defaultValue>true</defaultValue>

                <caseTrue>
                    <Operation Class="XmlExtensions.PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <ThingDef ParentName="DV_MeleeWeapon_Stunstick_Bond">
                                <defName>DV_MeleeWeapon_Stunstick_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="DV_PulseSMG_Bond">
                                <defName>DV_PulseSMG_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="DV_PulseRifle_Bond">
                                <defName>DV_PulseRifle_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="DV_PulseSuppressor_Bond">
                                <defName>DV_PulseSuppressor_Bond</defName>
                            </ThingDef>
                            <ThingDef ParentName="PulseBullet_Bond">
                                <defName>PulseBullet_Bond</defName>
                            </ThingDef>
                        </value>
                    </Operation>
                </caseTrue>
            </Operation>

        </caseTrue>
    </Operation>
</Patch>