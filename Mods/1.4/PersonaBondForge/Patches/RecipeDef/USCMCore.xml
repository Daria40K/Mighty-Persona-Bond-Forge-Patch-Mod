<?xml version="1.0" encoding="utf-8"?>
<!--
    ===== USCM - Core =====
-->
<Patch>
	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>USCM - Core</li>
		</mods>

		<match Class="PatchOperationSequence">
			<operations>
				<li Class="PatchOperationAdd">
					<xpath>Defs</xpath>
					<value>
						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M4A3_USCM_Bond" Abstract="True">
							<label>bond M4A3 Service Pistol</label>
							<description>Bond an M4A3 Service Pistol.</description>
							<jobString>Bonding a M4A3 Service Pistol.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M4A3_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M4A3_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M4A3_USCM_Bond>1</Gun_M4A3_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M4A4_USCM_Bond" Abstract="True">
							<label>bond M4A4 Pistol</label>
							<description>Bond an M4A4 Pistol.</description>
							<jobString>Bonding a M4A4 Pistol.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M4A4_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M4A4_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M4A4_USCM_Bond>1</Gun_M4A4_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_88mod4_USCM_Bond" Abstract="True">
							<label>bond 88 Mod 4 Combat Pistol</label>
							<description>Bond an 88 Mod 4 Combat Pistol.</description>
							<jobString>Bonding a 88 Mod 4 Combat Pistol.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_88mod4_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_88mod4_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_88mod4_USCM_Bond>1</Gun_88mod4_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M37A2_USCM_Bond" Abstract="True">
							<label>bond M37A2 Pump Shotgun</label>
							<description>Bond an M37A2 Pump Shotgun.</description>
							<jobString>Bonding a M37A2 Pump Shotgun.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M37A2_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M37A2_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M37A2_USCM_Bond>1</Gun_M37A2_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M41A_USCM_Bond" Abstract="True">
							<label>bond M41A Pulse Rifle</label>
							<description>Bond an M41A Pulse Rifle.</description>
							<jobString>Bonding a M41A Pulse Rifle.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M41A_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M41A_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M41A_USCM_Bond>1</Gun_M41A_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M42A_USCM_Bond" Abstract="True">
							<label>bond M42A Sniper Rifle</label>
							<description>Bond an M42A Sniper Rifle.</description>
							<jobString>Bonding a M42A Sniper Rifle.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M42A_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M42A_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M42A_USCM_Bond>1</Gun_M42A_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M56_USCM_Bond" Abstract="True">
							<label>bond M56 Smartgun</label>
							<description>Bond an M56 Smartgun.</description>
							<jobString>Bonding a M56 Smartgun.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M56_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M56_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M56_USCM_Bond>1</Gun_M56_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M240_USCM_Bond" Abstract="True">
							<label>bond M240 Incinerator Unit</label>
							<description>Bond an M240 Incinerator Unit.</description>
							<jobString>Bonding a M240 Incinerator Unit.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M240_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M240_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M240_USCM_Bond>1</Gun_M240_USCM_Bond>
							</products>
						</RecipeDef>

						<RecipeDef ParentName="MPBFPM_RecipeDefBase" Name="Make_Gun_M5_USCM_Bond" Abstract="True">
							<label>bond M5 Rocket Propelled Grenade</label>
							<description>Bond an M5 Rocket Propelled Grenade.</description>
							<jobString>Bonding a M5 Rocket Propelled Grenade.</jobString>
							<researchPrerequisite>Bound_Research</researchPrerequisite>
							<ingredients>
								<li>
									<filter>
										<thingDefs>
											<li>Gun_M5_USCM</li>
										</thingDefs>
									</filter>
									<count>1</count>
								</li>
							</ingredients>
							<fixedIngredientFilter>
								<thingDefs>
									<li>Gun_M5_USCM</li>
								</thingDefs>
							</fixedIngredientFilter>
							<products>
								<Gun_M5_USCM_Bond>1</Gun_M5_USCM_Bond>
							</products>
						</RecipeDef>
					</value>
				</li>

				<li Class="PatchOperationFindMod">
					<mods>
						<li>XML Extensions</li>
					</mods>

					<nomatch Class="PatchOperationAdd">
						<xpath>Defs</xpath>
						<value>
							<!-- Make_Gun_M4A3_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M4A3_USCM_Bond">
								<defName>Make_Gun_M4A3_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M4A4_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M4A4_USCM_Bond">
								<defName>Make_Gun_M4A4_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_88mod4_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_88mod4_USCM_Bond">
								<defName>Make_Gun_88mod4_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M37A2_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M37A2_USCM_Bond">
								<defName>Make_Gun_M37A2_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M41A_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M41A_USCM_Bond">
								<defName>Make_Gun_M41A_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M42A_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M42A_USCM_Bond">
								<defName>Make_Gun_M42A_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M56_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M56_USCM_Bond">
								<defName>Make_Gun_M56_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M240_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M240_USCM_Bond">
								<defName>Make_Gun_M240_USCM_Bond</defName>
							</RecipeDef>

							<!-- Make_Gun_M5_USCM_Bond -->
							<RecipeDef ParentName="Make_Gun_M5_USCM_Bond">
								<defName>Make_Gun_M5_USCM_Bond</defName>
							</RecipeDef>
						</value>
					</nomatch>

					<match Class="PatchOperationSequence">
						<operations>
							<li Class="XmlExtensions.OptionalPatch" MayRequire="imranfish.xmlextensions">
								<modId>Daria40K.MightyPersonaBondForgePatch</modId>
								<key>Daria40K_MightyPersonaBondForgePatch_USCMCore</key>
								<defaultValue>true</defaultValue>

								<caseTrue>
									<Operation Class="XmlExtensions.PatchOperationAdd">
										<xpath>Defs</xpath>
										<value>
											<!-- Make_Gun_M4A3_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M4A3_USCM_Bond">
												<defName>Make_Gun_M4A3_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M4A4_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M4A4_USCM_Bond">
												<defName>Make_Gun_M4A4_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_88mod4_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_88mod4_USCM_Bond">
												<defName>Make_Gun_88mod4_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M37A2_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M37A2_USCM_Bond">
												<defName>Make_Gun_M37A2_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M41A_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M41A_USCM_Bond">
												<defName>Make_Gun_M41A_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M42A_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M42A_USCM_Bond">
												<defName>Make_Gun_M42A_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M56_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M56_USCM_Bond">
												<defName>Make_Gun_M56_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M240_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M240_USCM_Bond">
												<defName>Make_Gun_M240_USCM_Bond</defName>
											</RecipeDef>

											<!-- Make_Gun_M5_USCM_Bond -->
											<RecipeDef ParentName="Make_Gun_M5_USCM_Bond">
												<defName>Make_Gun_M5_USCM_Bond</defName>
											</RecipeDef>
										</value>
									</Operation>
								</caseTrue>
							</li>
						</operations>
					</match>
				</li>
			</operations>
		</match>
	</Operation>
</Patch>
